<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EagleReach</title>
  <meta name="description" content="EagleReach ‚Äî fast, trustworthy civic info for U.S. residents." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --brand:#0b5ed7;            /* primary blue */
      --brand-600:#094caf;
      --ink:#0b1220;              /* text */
      --muted:#6b7280;            /* secondary text */
      --bg:#ffffff;               /* page bg */
      --card:#ffffff;
      --card-border:#e5e7eb;
      --pill:#e9f2ff;
      --shadow:0 10px 20px rgba(0,0,0,.05), 0 2px 6px rgba(0,0,0,.04);
      --radius:14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--ink);
      background:var(--bg);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    a{color:var(--brand);text-decoration:none}
    a:hover{text-decoration:underline}

    /* Header */
    .hdr{
      position:sticky;top:0;z-index:50;
      background:#0a3d91;       /* Navy band */
      color:#fff;
      box-shadow:var(--shadow);
    }
    .hdr-in{
      max-width:1160px;margin:0 auto;
      padding:12px 16px;display:flex;align-items:center;gap:14px;
    }
    .flag{font-size:18px}
    .title{font-weight:800;letter-spacing:.2px;font-size:18px}
    .quote{margin-left:auto;font-size:13px;opacity:.9;white-space:nowrap}
    .nav{display:flex;gap:20px;margin-left:20px}
    .nav a{color:#fff;opacity:.9;font-weight:600}
    .nav a:hover{opacity:1}

    /* Mobile top row wrap */
    @media (max-width:840px){
      .hdr-in{flex-wrap:wrap;row-gap:8px}
      .quote{order:3;width:100%;margin-left:0;white-space:normal}
      .nav{order:2;margin-left:0}
    }

    /* Layout */
    .wrap{max-width:1160px;margin:28px auto;padding:0 16px}
    .row{display:grid;grid-template-columns:1.3fr .9fr;gap:20px}
    @media (max-width:980px){.row{grid-template-columns:1fr}}

    /* Cards & buttons */
    .card{
      background:var(--card);border:1px solid var(--card-border);
      border-radius:var(--radius);box-shadow:var(--shadow);
    }
    .card-body{padding:18px}
    .card h3{
      margin:0 0 12px;font-size:16px;font-weight:800;color:#1f2937;
      letter-spacing:.2px
    }
    .btn{
      display:inline-flex;align-items:center;gap:8px;
      background:var(--brand);color:#fff;border:0;border-radius:12px;
      padding:10px 14px;font-weight:700;cursor:pointer
    }
    .btn:disabled{opacity:.55;cursor:not-allowed}
    .btn:hover{background:var(--brand-600)}
    .btn-alt{
      background:#eef2ff;color:#1f3a8a;border:1px solid #c7d2fe
    }
    .btn-alt:hover{background:#e0e7ff}
    .btn-ghost{
      background:#f8fafc;color:#0f172a;border:1px solid #e5e7eb
    }
    .input{
      width:100%;padding:12px 14px;border:1px solid #dfe3ea;border-radius:12px;
      outline:none;font-weight:600
    }
    .stack{display:flex;gap:10px;flex-wrap:wrap}

    /* Officials list */
    .official{border:1px solid var(--card-border);border-radius:12px;padding:12px;margin:8px 0}
    .official h4{margin:0 0 8px;font-size:15px}
    .sm{font-size:13px;color:var(--muted)}
    .pill{
      display:inline-flex;align-items:center;gap:6px;
      padding:8px 12px;border-radius:999px;background:var(--pill);
      border:1px solid #cfe2ff;color:#0b3b8f;font-weight:700
    }

    /* Footer */
    .ft{color:var(--muted);font-size:12px;text-align:center;margin:28px 0}

    /* Modal (About / Founder / Contact) */
    .modal-back{
      position:fixed;inset:0;background:rgba(2,6,23,.5);
      display:none;align-items:flex-start;justify-content:center;padding:20px;z-index:60
    }
    .modal{width:min(760px,100%);background:#fff;border-radius:16px;box-shadow:var(--shadow)}
    .modal-h{
      padding:16px 18px;border-bottom:1px solid #edf2f7;display:flex;align-items:center;gap:10px
    }
    .modal-h h3{margin:0;font-size:18px}
    .modal-x{margin-left:auto;background:#f1f5f9;border:1px solid #e2e8f0;border-radius:10px;padding:8px 10px;cursor:pointer}
    .modal-b{padding:16px 18px;line-height:1.6}
    .modal-back.show{display:flex}
  </style>
</head>
<body>

  <!-- Header -->
  <header class="hdr">
    <div class="hdr-in">
      <span class="flag" aria-hidden="true">üá∫üá∏</span>
      <span class="title">EagleReach</span>
      <nav class="nav">
        <a href="#" data-open="about">About</a>
        <a href="#" data-open="founder">Founder</a>
        <a href="#" data-open="contact">Contact</a>
        <a href="#" data-open="feedback">Feedback</a>
      </nav>
      <div class="quote">Civic info, fast &amp; free ‚Äî built for everyone.</div>
    </div>
  </header>

  <main class="wrap">
    <!-- Search -->
    <section class="card" aria-labelledby="zipsearch">
      <div class="card-body">
        <h3 id="zipsearch">Enter ZIP</h3>
        <div class="stack" style="align-items:center">
          <input id="zip" class="input" placeholder="ZIP (e.g., 45220)" inputmode="numeric" />
          <button id="btnLocate" class="btn" title="Use my location">üìç Use my location</button>
          <button id="btnSearch" class="btn">üîé Search</button>
          <button id="btnCopy" class="btn-ghost" title="Copy a shareable link">üîó Copy Share Link</button>
          <button id="btnClear" class="btn-alt" title="Clear search">üßπ Clear history</button>
        </div>
        <div id="placeLine" class="sm" style="margin-top:10px"></div>
      </div>
    </section>

    <div class="row" style="margin-top:14px">
      <!-- LEFT COLUMN -->
      <div class="col">
        <!-- Officials -->
        <section class="card" aria-labelledby="reps">
          <div class="card-body">
            <h3 id="reps">Elected Representatives</h3>
            <div id="officials"></div>
            <div class="sm" style="margin-top:10px">
              Sources: GovTrack (Congress), WhoIsMyRepresentative (House), FCC, Zippopotam.
            </div>
          </div>
        </section>

        <!-- News -->
        <section class="card" style="margin-top:14px" aria-labelledby="news">
          <div class="card-body">
            <h3 id="news">News</h3>
            <div class="stack">
              <a class="pill" target="_blank" rel="noopener" id="btnLocalNews">Open Local News</a>
              <a class="pill" target="_blank" rel="noopener" id="btnWorldNews">World News</a>
            </div>
            <div class="sm" style="margin-top:8px">Opens news in a new tab.</div>
          </div>
        </section>

        <!-- Raise a Concern -->
        <section class="card" style="margin-top:14px" aria-labelledby="concern">
          <div class="card-body">
            <h3 id="concern">Raise a Concern</h3>
            <div class="stack">
              <a class="pill" href="#" id="conc-potholes">Potholes</a>
              <a class="pill" href="#" id="conc-trash">Trash</a>
              <a class="pill" href="#" id="conc-lights">Street lights</a>
            </div>
            <div class="sm" style="margin-top:8px">
              Report city issues (311), contact your city hall, or write to your representatives.
            </div>
          </div>
        </section>

        <!-- Emergency -->
        <section class="card" style="margin-top:14px" aria-labelledby="emerg">
          <div class="card-body">
            <h3 id="emerg">Emergency</h3>
            <div class="stack">
              <a class="pill" href="tel:911">911 ‚Äî Emergency</a>
              <a class="pill" href="tel:988">988 ‚Äî Suicide &amp; Crisis</a>
              <a class="pill" href="tel:211">211 ‚Äî Community Services</a>
              <a class="pill" href="tel:311">311 ‚Äî City Services</a>
              <a class="pill" href="tel:811">811 ‚Äî Before You Dig</a>
              <a class="pill" href="tel:+18002221222">Poison Control</a>
            </div>
          </div>
        </section>

        <div class="ft">¬© 2025 EagleReach</div>
      </div>

      <!-- RIGHT COLUMN -->
      <div class="col">
        <!-- Voter Info -->
        <section class="card" aria-labelledby="vote">
          <div class="card-body">
            <h3 id="vote">Voter Info &amp; Education</h3>
            <div class="stack">
              <a class="btn" target="_blank" rel="noopener" href="https://www.usa.gov/how-to-vote">How to vote (USA.gov)</a>
              <a class="btn" target="_blank" rel="noopener" href="https://www.usa.gov/register-to-vote">Register to vote</a>
              <a class="btn" target="_blank" rel="noopener" href="https://www.usa.gov/election-office">Find your Election Office</a>
            </div>
          </div>
        </section>

        <!-- Elections -->
        <section class="card" style="margin-top:14px" aria-labelledby="elex">
          <div class="card-body">
            <h3 id="elex">Upcoming Elections</h3>
            <div id="elexNext" class="btn-ghost" style="padding:10px 12px;border-radius:12px;display:inline-block">Next Federal: ‚Äî</div>
          </div>
        </section>

        <!-- Traffic -->
        <section class="card" style="margin-top:14px" aria-labelledby="traffic">
          <div class="card-body">
            <h3 id="traffic">Traffic</h3>
            <div class="sm" style="margin-bottom:10px">Open live traffic for your area in Google Maps.</div>
            <a id="btnTraffic" class="btn" target="_blank" rel="noopener">Open Traffic Map</a>
          </div>
        </section>

        <!-- Weather -->
        <section class="card" style="margin-top:14px" aria-labelledby="wx">
          <div class="card-body">
            <h3 id="wx">Local Weather (7-day)</h3>
            <div id="weather"></div>
          </div>
        </section>
      </div>
    </div>
  </main>

  <!-- ABOUT MODAL -->
  <div class="modal-back" id="aboutModal">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="aboutHd">
      <div class="modal-h">
        <h3 id="aboutHd">About EagleReach</h3>
        <button class="modal-x" data-close>Close</button>
      </div>
      <div class="modal-b">
        <p><strong>EagleReach</strong> is a civic engagement platform created by <strong>Vikesh Sagar Bairam</strong> to
          help residents quickly find their elected representatives, voter education, weather, and local resources using a
          simple ZIP-code search. The app is free to use and requires no sign-in.</p>
        <p>Our purpose is to make civic information <strong>transparent, accessible, and user-friendly</strong> ‚Äî so anyone
          can participate in their democracy with confidence. EagleReach aggregates open data from trusted sources and
          presents it in a clean, mobile-friendly interface.</p>
        <p><strong>What you get:</strong> representatives and contact links, voter education (How to vote, Register, and Find
          your election office), timely local weather, an easy way to raise city concerns, and one-tap access to emergency
          numbers.</p>
      </div>
    </div>
  </div>

  <!-- FOUNDER MODAL -->
  <div class="modal-back" id="founderModal">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="founderHd">
      <div class="modal-h">
        <h3 id="founderHd">Founder</h3>
        <button class="modal-x" data-close>Close</button>
      </div>
      <div class="modal-b">
        <p><strong>Vikesh Sagar Bairam</strong> is a Data Analyst and Cloud Specialist with experience across
          analytics, DevOps, and civic-focused product development. He is passionate about building solutions that are
          simple, reliable, and useful for everyone.</p>
        <p><strong>Current &amp; previous roles:</strong> Data Specialist/Analyst at Jabil; Data Analyst at
          S&amp;P Global (IHS Markit); DevOps Engineer at Techtate; Supply Chain Specialist at Auscomp Computers; and
          DevOps Engineering Intern at Surfaces by Pacific.</p>
        <p><strong>Education &amp; certifications:</strong> Master‚Äôs in Information Systems &amp; Management from the
          University of Illinois, Springfield ‚Äî with focus areas spanning AI/ML and cloud technologies. He also completed a
          bachelor‚Äôs in Psychology and Arts (Osmania University) and a bachelor‚Äôs in Computers. He is certified as a
          <em>Google Cloud Professional Data Engineer</em>.</p>
        <p>Vikesh enjoys leading by example, collaborating across teams, and turning ideas into products that make civic
          participation easier and more inclusive.</p>
      </div>
    </div>
  </div>

  <!-- CONTACT / FEEDBACK MODAL (shared) -->
  <div class="modal-back" id="contactModal">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="contactHd">
      <div class="modal-h">
        <h3 id="contactHd">Contact</h3>
        <button class="modal-x" data-close>Close</button>
      </div>
      <div class="modal-b">
        <p>Email: <a href="mailto:vikebairam@gmail.com">vikebairam@gmail.com</a></p>
        <p>LinkedIn: <a target="_blank" rel="noopener" href="https://www.linkedin.com/in/vikesh-bairam-219769258/">linkedin.com/in/vikesh-bairam-219769258/</a></p>
        <p>GitHub: <a target="_blank" rel="noopener" href="https://github.com/vikesh2608">github.com/vikesh2608</a></p>
      </div>
    </div>
  </div>

  <div class="modal-back" id="feedbackModal">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="fbHd">
      <div class="modal-h">
        <h3 id="fbHd">Feedback</h3>
        <button class="modal-x" data-close>Close</button>
      </div>
      <div class="modal-b">
        <p>Have suggestions? Send a quick note: <a href="mailto:vikebairam@gmail.com?subject=EagleReach%20Feedback">vikebairam@gmail.com</a></p>
      </div>
    </div>
  </div>

  <script>
    // ==== CONFIG ====
    const API_BASE = (location.hostname.endsWith('github.io'))
      ? 'https://eaglereach-api.fly.dev'   // <- your deployed API base (change if needed)
      : 'http://localhost:8000';

    // If you deploy at some other domain, update API_BASE above.
    // =================

    const $ = sel => document.querySelector(sel);
    const officialsEl = $('#officials');
    const weatherEl  = $('#weather');
    const nextEl     = $('#elexNext');
    const zipInput   = $('#zip');
    const placeLine  = $('#placeLine');

    // ===== Helpers =====
    function setPlaceLine(z) {
      placeLine.textContent = z?.zip ? `${z.zip} ‚Äî ${z.place || ''}${z.state ? ', ' + z.state : ''}` : '';
    }
    function shareLinkFromZip(zip) {
      const url = new URL(location.href);
      if (zip) url.searchParams.set('zip', zip); else url.searchParams.delete('zip');
      return url.toString();
    }
    function openModal(id){ document.getElementById(id).classList.add('show'); }
    function closeModals(){ document.querySelectorAll('.modal-back').forEach(m=>m.classList.remove('show')); }

    document.querySelectorAll('[data-open]').forEach(a=>{
      a.addEventListener('click',e=>{
        e.preventDefault();
        const id=a.dataset.open;
        if(id==='about') openModal('aboutModal');
        if(id==='founder') openModal('founderModal');
        if(id==='contact') openModal('contactModal');
        if(id==='feedback') openModal('feedbackModal');
      });
    });
    document.querySelectorAll('[data-close]').forEach(b=>b.addEventListener('click',closeModals));
    document.querySelectorAll('.modal-back').forEach(back=>{
      back.addEventListener('click',e=>{
        if(e.target===back) closeModals();
      });
    });

    // ===== API calls =====
    async function getJSON(path, params={}){
      const url = new URL(API_BASE + path);
      Object.entries(params).forEach(([k,v]) => url.searchParams.set(k,v));
      const r = await fetch(url.toString());
      if(!r.ok) throw new Error(`${r.status} ${await r.text()}`);
      return r.json();
    }

    async function loadAll(zip){
      // zip info
      const z = await getJSON('/zipinfo', {zip});
      setPlaceLine(z);

      // officials
      const reps = await getJSON('/officials', {zip});
      officialsEl.innerHTML = (reps.officials || []).map(o => `
        <div class="official">
          <h4>${o.name || 'Unknown'}</h4>
          <div class="sm">${o.office || ''}${o.party ? ' ‚Äî ' + o.party : ''}</div>
          <div class="stack" style="margin-top:8px">
            ${ (o.urls||[]).map(u=>`<a class="pill" target="_blank" rel="noopener" href="${u}">Website</a>`).join('') }
            ${ (o.phones||[]).map(p=>`<a class="pill" href="tel:${p.replace(/[^+0-9]/g,'')}">Call</a>`).join('') }
          </div>
        </div>
      `).join('') || '<div class="sm">No officials found.</div>';

      // weather
      const wx = await getJSON('/weather', {zip});
      weatherEl.innerHTML = (wx.days||[]).map(d => `
        <div class="official" style="display:flex;justify-content:space-between;align-items:center">
          <div><strong>${d.date}</strong><div class="sm">${d.summary||''}</div></div>
          <div class="sm">${d.max ?? '‚Äî'}¬∞ / ${d.min ?? '‚Äî'}¬∞</div>
        </div>
      `).join('') || '<div class="sm">Weather unavailable.</div>';

      // elections
      const elx = await getJSON('/elections', {zip});
      nextEl.textContent = `Next Federal: ${elx?.next?.federal || '‚Äî'}`;

      // news buttons (open in new tab)
      const q = encodeURIComponent(`${z.place || ''} ${z.state || ''} local news`);
      $('#btnLocalNews').href = `https://news.google.com/search?q=${q}`;
      $('#btnWorldNews').href = `https://news.google.com/home?hl=en-US&gl=US&ceid=US:en`;

      // traffic
      const mapLatLng = (z.lat && z.lon) ? `${z.lat},${z.lon}` : '';
      $('#btnTraffic').href = `https://www.google.com/maps/@?api=1&map_action=map&layer=traffic&center=${mapLatLng}`;
    }

    // ===== Actions =====
    async function searchZip(){
      const zip = zipInput.value.trim();
      if(!zip) return;
      try{
        await loadAll(zip);
        history.replaceState({}, '', shareLinkFromZip(zip));
      }catch(err){
        alert('Could not load data for that ZIP. Please try another.');
        console.error(err);
      }
    }

    async function useMyLocation(){
      try{
        $('#btnLocate').disabled = true;
        const pos = await new Promise((res,rej)=>navigator.geolocation.getCurrentPosition(res,rej,{enableHighAccuracy:true,timeout:10000}));
        const data = await getJSON('/reverse-zip', {lat:pos.coords.latitude, lon:pos.coords.longitude});
        if(!data.zip) throw new Error('ZIP not found from location');
        zipInput.value = data.zip;
        await searchZip();
      }catch(err){
        alert('Could not resolve ZIP from your location. You can type a ZIP manually.');
        console.warn(err);
      }finally{
        $('#btnLocate').disabled = false;
      }
    }

    // Share / Clear
    $('#btnCopy').addEventListener('click', async ()=>{
      const zip = zipInput.value.trim();
      const link = shareLinkFromZip(zip);
      try{ await navigator.clipboard.writeText(link); alert('Link copied!'); }
      catch{ prompt('Copy this link:', link); }
    });
    $('#btnClear').addEventListener('click', ()=>{
      zipInput.value=''; placeLine.textContent=''; officialsEl.innerHTML=''; weatherEl.innerHTML=''; nextEl.textContent='Next Federal: ‚Äî';
      history.replaceState({}, '', shareLinkFromZip(''));
    });

    $('#btnSearch').addEventListener('click', searchZip);
    $('#btnLocate').addEventListener('click', useMyLocation);
    zipInput.addEventListener('keydown', e=>{ if(e.key==='Enter') searchZip(); });

    // Init from ?zip=
    const startZip = new URL(location.href).searchParams.get('zip');
    if(startZip){ zipInput.value = startZip; searchZip(); }
  </script>
</body>
</html>
