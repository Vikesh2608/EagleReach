<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EagleReach</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <style>
    body { background: #f8f9fa; }
    header {
      background: #0d47a1;
      color: white;
      padding: 0.75rem 1.25rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    header .brand { display: flex; align-items: center; gap: 0.5rem; }
    header img.flag { height: 22px; }
    header nav a {
      color: white; margin-left: 20px;
      text-decoration: none; font-weight: 500;
    }
    header nav a:hover { text-decoration: underline; }

    .container { margin-top: 1rem; max-width: 1100px; }
    .card { margin-bottom: 1rem; }

    /* Button color fix */
    .btn-primary {
      background-color: #0d6efd !important;
      border-color: #0d6efd !important;
    }

    footer {
      text-align: center; margin-top: 2rem;
      padding: 1rem; font-size: 0.9rem; color: #666;
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg"
           alt="US Flag" class="flag">
      <strong>EagleReach</strong>
    </div>
    <small>Civic info, fast & free ‚Äî built for everyone.</small>
    <nav>
      <a href="#" onclick="showTab('about')">About</a>
      <a href="#" onclick="showTab('founder')">Founder</a>
      <a href="#" onclick="showTab('contact')">Contact</a>
      <a href="#" onclick="showTab('feedback')">Feedback</a>
    </nav>
  </header>

  <div class="container" id="main">
    <!-- ZIP input -->
    <div class="card p-3">
      <label for="zipInput" class="form-label fw-bold">Enter ZIP</label>
      <div class="input-group">
        <input id="zipInput" class="form-control" placeholder="ZIP (e.g., 45220)">
        <button class="btn btn-danger" id="btnLocate" onclick="useMyLocation()">üìç Use my location</button>
        <button class="btn btn-primary" onclick="searchZip()">üîç Search</button>
        <button class="btn btn-outline-secondary" onclick="copyLink()">üìã Copy Share Link</button>
        <button class="btn btn-outline-secondary" onclick="clearHistory()">üóë Clear history</button>
      </div>
    </div>

    <!-- Elected reps -->
    <div class="row">
      <div class="col-md-8">
        <div class="card p-3">
          <h5 class="fw-bold">Elected Representatives</h5>
          <div id="officials"></div>
          <small class="text-muted">Sources: GovTrack (Congress), WhoIsMyRepresentative (House), FCC, Zippopotam.</small>
        </div>
      </div>

      <!-- Voter info -->
      <div class="col-md-4">
        <div class="card p-3">
          <h6 class="fw-bold">Voter Info & Education</h6>
          <button class="btn btn-primary w-100 mb-2" onclick="window.open('https://www.usa.gov/how-to-vote','_blank')">How to vote (USA.gov)</button>
          <button class="btn btn-primary w-100 mb-2" onclick="window.open('https://www.nass.org/can-I-vote','_blank')">Register to vote</button>
          <button class="btn btn-primary w-100" onclick="window.open('https://www.nass.org/can-I-vote','_blank')">Find your Election Office</button>
        </div>
      </div>
    </div>

    <!-- News + Elections -->
    <div class="row">
      <div class="col-md-6">
        <div class="card p-3">
          <h6 class="fw-bold">News</h6>
          <button class="btn btn-dark me-2" onclick="window.open('https://news.google.com','_blank')">Open Local News</button>
          <button class="btn btn-dark" onclick="window.open('https://www.bbc.com/news','_blank')">World News</button>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card p-3">
          <h6 class="fw-bold">Upcoming Elections</h6>
          <div id="elections">Next Federal: ‚Äî</div>
        </div>
      </div>
    </div>

    <!-- Traffic + Weather -->
    <div class="row">
      <div class="col-md-6">
        <div class="card p-3">
          <h6 class="fw-bold">Traffic</h6>
          <p>Open live traffic for your area in Google Maps.</p>
          <button class="btn btn-primary" onclick="openTraffic()">Open Traffic Map</button>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card p-3">
          <h6 class="fw-bold">Local Weather (7-day)</h6>
          <div id="weather"></div>
        </div>
      </div>
    </div>

    <!-- Concerns -->
    <div class="card p-3">
      <h6 class="fw-bold">Raise a Concern</h6>
      <button class="btn btn-primary me-2">Potholes</button>
      <button class="btn btn-primary me-2">Trash</button>
      <button class="btn btn-primary">Street lights</button>
      <p class="text-muted small">Report city issues (311), contact your city hall, or write to your representatives.</p>
    </div>

    <!-- Emergency -->
    <div class="card p-3">
      <h6 class="fw-bold">Emergency</h6>
      <button class="btn btn-primary me-2">911 ‚Äî Emergency</button>
      <button class="btn btn-primary me-2">988 ‚Äî Suicide & Crisis</button>
      <button class="btn btn-primary me-2">211 ‚Äî Community Services</button>
      <button class="btn btn-primary me-2">311 ‚Äî City Services</button>
      <button class="btn btn-primary me-2">811 ‚Äî Before You Dig</button>
      <button class="btn btn-primary">Poison Control</button>
    </div>
  </div>

  <!-- Tabs -->
  <div class="container" id="about" style="display:none">
    <div class="card p-3">
      <h4>About EagleReach</h4>
      <p>
        EagleReach is a civic information assistant designed to help residents quickly access
        their elected officials, voter resources, weather, traffic, and news ‚Äî all without
        needing to log in. Built for society and individuals alike, it empowers people with
        trustworthy data at their fingertips.
      </p>
      <p>
        Features include ZIP-based lookup, one-tap location detection, links to official resources,
        live traffic, and weather updates. The mission is to make civic access fast, free,
        and accessible for everyone.
      </p>
    </div>
  </div>

  <div class="container" id="founder" style="display:none">
    <div class="card p-3">
      <h4>Founder</h4>
      <p>
        <strong>Vikesh Sagar Bairam</strong> is a Master's graduate from the University of Illinois, Springfield,
        specializing in Information Systems and Management with a focus on AI & ML. He also holds
        Bachelor's degrees in Psychology, Arts, and Computers. Certified as a
        <em>Professional Data Engineer (Google Cloud Platform)</em>, Vikesh has worked across roles
        including Data Analyst at S&P Global (IHS Markit), Supply Chain Specialist at Auscomp Computers,
        DevOps Engineer at Techtate, and Test Engineer at Jabil.
      </p>
      <p>
        With strong leadership skills and a passion for automation, data, and AI/ML cloud solutions,
        Vikesh built EagleReach as a service to the community. His vision is to create technologies
        that delight end users, simplify access to critical information, and optimize processes
        regardless of time or complexity.
      </p>
    </div>
  </div>

  <div class="container" id="contact" style="display:none">
    <div class="card p-3">
      <h4>Contact</h4>
      <p>You can reach the team at <a href="mailto:vikesh2608@gmail.com">vikesh2608@gmail.com</a></p>
    </div>
  </div>

  <div class="container" id="feedback" style="display:none">
    <div class="card p-3">
      <h4>Feedback</h4>
      <p>We welcome your suggestions to improve EagleReach. Please share your ideas to help us grow.</p>
    </div>
  </div>

  <footer>¬© 2025 EagleReach</footer>

  <script>
    const apiBase = "https://your-backend-here"; // replace with Render/hosted backend URL
    const zipInput = document.getElementById('zipInput');

    async function getJSON(path, params={}){
      const url = new URL(apiBase + path);
      Object.entries(params).forEach(([k,v])=>url.searchParams.set(k,v));
      const res = await fetch(url);
      if(!res.ok) throw new Error(await res.text());
      return res.json();
    }

    async function searchZip(){
      const zip = zipInput.value.trim();
      if(!zip) return;
      try{
        const officials = await getJSON('/officials',{zip});
        renderOfficials(officials);

        const wx = await getJSON('/weather',{zip});
        renderWeather(wx);

        const elect = await getJSON('/elections',{zip});
        document.getElementById('elections').innerText =
          "Next Federal: " + (elect.next.federal || "‚Äî");
      }catch(e){ alert("Search failed: "+e); }
    }

    function renderOfficials(data){
      const div = document.getElementById('officials');
      div.innerHTML = "";
      (data.officials||[]).forEach(o=>{
        const card = document.createElement('div');
        card.className = "border rounded p-2 mb-2";
        card.innerHTML = `<strong>${o.name}</strong><br>${o.office || ""}<br>
          ${o.party||""}<br>
          ${o.phones?`<a href="tel:${o.phones[0]}" class="btn btn-sm btn-outline-dark">Call</a>`:""}
          ${o.urls?`<a href="${o.urls[0]}" target="_blank" class="btn btn-sm btn-outline-dark">Website</a>`:""}`;
        div.appendChild(card);
      });
    }

    function renderWeather(wx){
      const div = document.getElementById('weather');
      div.innerHTML = "";
      (wx.days||[]).forEach(d=>{
        const p = document.createElement('div');
        p.className = "border rounded p-1 mb-1";
        p.innerText = `${d.date}: ${d.summary} (High ${d.max}¬∞ / Low ${d.min}¬∞)`;
        div.appendChild(p);
      });
    }

    function copyLink(){
      const url = location.origin + location.pathname + "?zip=" + zipInput.value;
      navigator.clipboard.writeText(url);
      alert("Link copied: "+url);
    }
    function clearHistory(){ zipInput.value=""; document.getElementById('officials').innerHTML=""; }

    async function useMyLocation(){
      const btn = document.getElementById('btnLocate');
      try{
        btn.disabled = true;
        const pos = await new Promise((res,rej)=>
          navigator.geolocation.getCurrentPosition(res,rej,{enableHighAccuracy:true,timeout:12000})
        );
        try{
          const data = await getJSON('/reverse-zip',{lat:pos.coords.latitude,lon:pos.coords.longitude});
          if(data?.zip){ zipInput.value=data.zip; await searchZip(); return; }
        }catch(e){ console.warn("reverse-zip failed",e); }
        // IP fallback
        const r = await fetch('https://ipapi.co/json/');
        const j = await r.json();
        if(j?.postal){ zipInput.value=j.postal; await searchZip(); return; }
        alert("Could not resolve ZIP from your location. You can type a ZIP manually.");
      }catch(err){
        console.warn("geo fail",err);
        try{
          const r = await fetch('https://ipapi.co/json/'); const j=await r.json();
          if(j?.postal){ zipInput.value=j.postal; await searchZip(); return; }
        }catch(e){}
        alert("Could not resolve ZIP from your location. You can type a ZIP manually.");
      }finally{ btn.disabled=false; }
    }

    function openTraffic(){
      const zip = zipInput.value.trim();
      if(!zip){ alert("Enter ZIP first"); return; }
      window.open(`https://www.google.com/maps/search/${zip}+traffic`,"_blank");
    }

    // Tab navigation
    function showTab(id){
      ["main","about","founder","contact","feedback"].forEach(t=>document.getElementById(t).style.display="none");
      document.getElementById(id).style.display="block";
    }

    // Auto search from ?zip=
    window.onload = ()=>{
      const params = new URLSearchParams(location.search);
      const zip = params.get("zip");
      if(zip){ zipInput.value=zip; searchZip(); }
    }
  </script>
</body>
</html>
