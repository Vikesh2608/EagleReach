<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>EagleReach</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light dark">
  <style>
    :root{
      --brand:#0b3b8c;         /* Navy bar */
      --brand-ink:#ffffff;     /* Text on navy */
      --ink:#0d1b2a;
      --muted:#6b7280;
      --card:#ffffff;
      --bg:#0b1220;
      --border:#1f2937;
      --btn:#3b82f6;
      --btn-ink:#fff;
      --btn-subtle:#0b1220;
      --link:#60a5fa;
      --shadow:0 8px 30px rgba(0,0,0,.35);
      --radius:14px;
    }

    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:#e5e7eb;font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans",Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";}
    a{color:var(--link);text-decoration:none}
    a:hover{text-decoration:underline}

    /* Header (quote removed) */
    .sitebar{
      position:sticky;top:0;z-index:50;
      background:var(--brand);
      color:var(--brand-ink);
      box-shadow:0 1px 0 rgba(255,255,255,.05);
    }
    .bar-wrap{
      max-width:1100px;margin:0 auto;
      display:flex;align-items:center;gap:18px;
      flex-wrap:wrap;                 /* wrap if needed */
      padding:12px 16px;
    }
    .brand{
      display:flex;align-items:center;gap:12px;
      font-weight:700;letter-spacing:.2px;min-width:0;
    }
    .brand .flag{font-size:18px}
    .brand .name{font-size:18px;white-space:nowrap}
    .nav{margin-left:auto;display:flex;gap:18px;flex-wrap:wrap}
    .nav button{
      background:transparent;border:0;color:var(--brand-ink);
      font:inherit;cursor:pointer;padding:6px 6px;border-radius:8px;
      white-space:nowrap;
    }
    .nav button:hover{background:rgba(255,255,255,.12)}
    @media (max-width:520px){
      .bar-wrap{gap:10px;padding:10px 12px}
      .nav{gap:12px}
      .brand .name{font-size:17px}
      .brand .flag{font-size:17px}
    }

    /* Container & cards */
    .wrap{max-width:1100px;margin:18px auto;padding:0 12px}
    .grid{display:grid;grid-template-columns:2fr 1fr;gap:16px}
    @media (max-width:960px){.grid{grid-template-columns:1fr}}
    .card{
      background:var(--card);border:1px solid var(--border);
      border-radius:var(--radius);box-shadow:var(--shadow);
      padding:14px 14px 10px 14px;color:#e5e7eb;
    }
    .card h3{
      margin:0 0 10px 0;font-size:16px;letter-spacing:.2px;color:#fff;
    }
    .muted{color:#9aa4b2;font-size:13px}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .controls .row{margin-top:8px}
    input[type="text"]{
      width:100%;max-width:420px;background:#0f172a;color:#e5e7eb;
      border:1px solid var(--border);border-radius:12px;padding:10px 12px;
      outline:0;
    }
    .btn{
      background:var(--btn);color:var(--btn-ink);
      border:0;border-radius:12px;padding:10px 12px;cursor:pointer;
      display:inline-flex;align-items:center;gap:6px;font-weight:600
    }
    .btn.secondary{background:var(--btn-subtle);color:#e5e7eb;border:1px solid var(--border)}
    .btn.ghost{background:transparent;color:#e5e7eb;border:1px dashed var(--border)}
    .list .item{
      padding:10px;border:1px solid var(--border);
      border-radius:12px;margin-bottom:8px;background:#0f172a
    }
    .list .title{font-weight:700;color:#fff}
    .note{color:#9aa4b2;font-size:13px}
    .kicker{font-weight:700}
    .pill{
      display:inline-flex;align-items:center;gap:6px;
      padding:6px 10px;border-radius:999px;background:#0b1220;border:1px solid var(--border);font-size:13px;color:#e5e7eb
    }
    .footer{margin:18px auto 48px;max-width:1100px;color:#9aa4b2;font-size:12px;text-align:center}

    /* Modal */
    .modal{position:fixed;inset:0;display:none;background:rgba(0,0,0,.45);align-items:center;justify-content:center;padding:20px;z-index:200}
    .modal.open{display:flex}
    .dialog{
      width:min(760px,96vw);max-height:88vh;overflow:auto;background:#0f172a;
      border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);padding:16px;color:#e5e7eb;
    }
    .dialog header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    .dialog .x{background:transparent;border:0;color:#e5e7eb;font-size:22px;cursor:pointer}
    ul{padding-left:18px;margin:.3rem 0}
    li{margin:.2rem 0}
    .stack{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    @media (max-width:960px){.stack{grid-template-columns:1fr}}
    .section-title{font-weight:800;margin-bottom:6px}
  </style>
</head>
<body>
  <!-- Header (no quote) -->
  <div class="sitebar">
    <div class="bar-wrap">
      <div class="brand">
        <span class="flag">üá∫üá∏</span>
        <span class="name">EagleReach</span>
        <span class="flag" title="Eagle">ü¶Ö</span>
      </div>
      <nav class="nav">
        <button data-open="about">About</button>
        <button data-open="founder">Founder</button>
        <button data-open="contact">Contact</button>
        <button data-open="feedback">Feedback</button>
      </nav>
    </div>
  </div>

  <!-- Main -->
  <div class="wrap">
    <!-- Controls -->
    <div class="card controls">
      <h3>Enter ZIP</h3>
      <input id="zipInput" type="text" inputmode="numeric" pattern="[0-9]*" placeholder="ZIP (e.g., 62704)">
      <div id="placeLine" class="muted" style="margin-top:6px;"></div>

      <div class="row" style="margin-top:10px">
        <button id="btnLocate" class="btn secondary">üìç Use my location</button>
        <button id="btnSearch" class="btn">üîé Search</button>
        <button id="btnCopyLink" class="btn secondary">üîó Copy Share Link</button>
        <button id="btnClear" class="btn ghost">üóëÔ∏è Clear history</button>
      </div>
    </div>

    <div class="grid" style="margin-top:12px">
      <div class="stack">
        <!-- Officials -->
        <div class="card">
          <h3><span class="kicker">Elected Representatives</span></h3>
          <div class="muted" style="margin-bottom:6px">Sources: GovTrack (Congress), WhoIsMyRepresentative (House), FCC, Zippopotam.</div>
          <div id="officials" class="list"></div>
        </div>

        <!-- Voter Info -->
        <div class="card">
          <h3><span class="kicker">Voter Info &amp; Education</span></h3>
          <div class="list">
            <div class="item"><a id="howToVote" target="_blank" rel="noopener">How to vote (USA.gov)</a></div>
            <div class="item"><a id="registerVote" target="_blank" rel="noopener">Register to vote</a></div>
            <div class="item"><a id="findOffice" target="_blank" rel="noopener">Find your Election Office</a></div>
          </div>
        </div>

        <!-- Weather -->
        <div class="card">
          <h3><span class="kicker">Local Weather (7-day)</span></h3>
          <div id="weatherList" class="list"></div>
        </div>

        <!-- Elections -->
        <div class="card">
          <h3><span class="kicker">Upcoming Elections</span></h3>
          <div class="list" id="elections">
            <div class="item" id="fedElection">Next Federal: ‚Äî</div>
          </div>
        </div>

        <!-- News -->
        <div class="card">
          <h3><span class="kicker">News</span></h3>
          <div class="row">
            <a id="openLocalNews" class="btn secondary" target="_blank" rel="noopener">Open Local News</a>
            <a id="openWorldNews" class="btn secondary" target="_blank" rel="noopener">World News</a>
          </div>
          <div class="note" style="margin-top:8px">Opens news in a new tab.</div>
        </div>

        <!-- Traffic -->
        <div class="card">
          <h3><span class="kicker">Traffic</span></h3>
          <div class="note" style="margin-bottom:8px">Open live traffic for your area in Google Maps.</div>
          <a id="trafficLink" class="btn" target="_blank" rel="noopener">Open Traffic Map</a>
        </div>

        <!-- Raise a Concern -->
        <div class="card" style="grid-column:1/-1">
          <h3><span class="kicker">Raise a Concern</span></h3>
          <div class="note" style="margin-bottom:8px">Report city issues (311), contact your city hall, or write to your representatives.</div>
          <div class="row">
            <a class="btn secondary" id="concernPotholes" target="_blank" rel="noopener">Potholes</a>
            <a class="btn secondary" id="concernTrash" target="_blank" rel="noopener">Trash</a>
            <a class="btn secondary" id="concernLights" target="_blank" rel="noopener">Street lights</a>
          </div>
        </div>

        <!-- Emergency -->
        <div class="card" style="grid-column:1/-1">
          <h3><span class="kicker">Emergency</span></h3>
          <div class="row" style="gap:10px;flex-wrap:wrap">
            <a class="btn" href="tel:911">911 ‚Äî Emergency</a>
            <a class="btn" style="background:#9333ea" href="tel:988">988 ‚Äî Suicide &amp; Crisis</a>
            <a class="btn" style="background:#059669" href="tel:211">211 ‚Äî Community Services</a>
            <a class="btn" style="background:#2563eb" href="tel:311">311 ‚Äî City Services</a>
            <a class="btn" style="background:#b45309" href="tel:811">811 ‚Äî Before You Dig</a>
            <a class="btn" style="background:#ea580c" href="tel:18002221222">Poison Control</a>
          </div>
          <div class="note" style="margin-top:8px">Tap a number to call.</div>
        </div>
      </div>
    </div>

    <div class="footer">¬© 2025 EagleReach. Built open-source.</div>
  </div>

  <!-- About -->
  <div class="modal" id="about">
    <div class="dialog">
      <header>
        <h3>About EagleReach</h3>
        <button class="x" data-close="about" aria-label="Close">√ó</button>
      </header>

      <p><b>EagleReach</b> helps every U.S. resident quickly find their elected representatives, voter information, local weather, and upcoming elections ‚Äî <b>without any sign-in</b> or tracking.</p>
      <p><b>Why it matters:</b> Access to clear, trustworthy civic information makes it easier for people to participate, get help, and hold leaders accountable. When information is simple and fast, more people get involved ‚Äî and communities benefit.</p>
      <p><b>What you can do here:</b></p>
      <ul>
        <li><b>Find your officials</b> ‚Äî names, offices, party, website links, and tap-to-call phone numbers.</li>
        <li><b>Get voter info</b> ‚Äî official USA.gov links to learn how to vote, register, and find your election office.</li>
        <li><b>See your weather</b> ‚Äî simple 7-day forecast.</li>
        <li><b>Know what‚Äôs next</b> ‚Äî upcoming election timing at a glance.</li>
        <li><b>Read news</b> ‚Äî quick access to local and world news.</li>
        <li><b>Emergency contacts</b> ‚Äî one-tap calling for 911, 988, 211, 311, 811, and Poison Control.</li>
      </ul>
      <p class="note">Built on reputable open data sources (GovTrack, WhoIsMyRepresentative, Open-Meteo, USA.gov, Zippopotam). No accounts. No paywalls.</p>
    </div>
  </div>

  <!-- Founder (UPDATED) -->
  <div class="modal" id="founder">
    <div class="dialog">
      <header>
        <h3>Founder</h3>
        <button class="x" data-close="founder" aria-label="Close">√ó</button>
      </header>

      <p><b>Vikesh</b> is a technology evangelist and business solutions architect with a focus on <b>DevOps</b>, <b>Data Engineering</b>, <b>Cloud</b>, and <b>Generative AI</b>. He holds a Master‚Äôs degree in Information Systems &amp; Management (with AI/ML) from the University of Illinois Springfield and also completed a Bachelor‚Äôs in Computers.</p>

      <p><b>Certifications:</b> Google Cloud <b>Professional Data Engineer</b>.</p>

      <p><b>Experience highlights:</b></p>
      <ul>
        <li><b>Jabil</b> ‚Äî Data Specialist / Analyst</li>
        <li><b>S&amp;P Global (IHS Markit)</b> ‚Äî Data Analyst</li>
        <li><b>Techtate</b> ‚Äî DevOps Engineer</li>
        <li><b>Auscomp Computers</b> ‚Äî Supply Chain Specialist</li>
        <li><b>Surfaces by Pacific</b> ‚Äî DevOps Engineering Intern</li>
      </ul>

      <p><b>Why EagleReach:</b> This project reflects a commitment to community and public service ‚Äî making civic information fast, respectful, and accessible to everyone.</p>
    </div>
  </div>

  <!-- Contact -->
  <div class="modal" id="contact">
    <div class="dialog">
      <header>
        <h3>Contact</h3>
        <button class="x" data-close="contact" aria-label="Close">√ó</button>
      </header>
      <div class="list">
        <div class="item"><a href="https://www.linkedin.com/in/vikesh-bairam-219769258/" target="_blank" rel="noopener">LinkedIn ‚Äî Vikesh Bairam</a></div>
        <div class="item"><a href="https://github.com/vikesh2608" target="_blank" rel="noopener">GitHub ‚Äî vikesh2608</a></div>
        <div class="item"><a href="mailto:vikebairam@gmail.com">Email ‚Äî vikebairam@gmail.com</a></div>
      </div>
    </div>
  </div>

  <!-- Feedback -->
  <div class="modal" id="feedback">
    <div class="dialog">
      <header>
        <h3>Feedback</h3>
        <button class="x" data-close="feedback" aria-label="Close">√ó</button>
      </header>
      <p>Have ideas or found a bug? I‚Äôd love to hear from you.</p>
      <p><a class="btn" href="mailto:vikebairam@gmail.com?subject=EagleReach%20Feedback">Send feedback by email</a></p>
    </div>
  </div>

  <script>
    const API_BASE = 'https://eaglereach-1.onrender.com';  // backend

    const $ = sel => document.querySelector(sel);
    const el = (tag, attrs={}, children=[])=>{
      const n = document.createElement(tag);
      Object.entries(attrs||{}).forEach(([k,v])=>{
        if(k==='className') n.className=v;
        else if(k==='innerText') n.innerText=v;
        else if(k==='html') n.innerHTML=v;
        else n.setAttribute(k,v);
      });
      (Array.isArray(children)?children:[children]).filter(Boolean).forEach(c=>n.append(c));
      return n;
    };
    const copy = async text => { try{ await navigator.clipboard.writeText(text); alert('Copied!'); } catch(e){ prompt('Copy:', text); } };

    async function fetchJson(path, params){
      const url = new URL(API_BASE + path);
      Object.entries(params||{}).forEach(([k,v])=>url.searchParams.set(k,v));
      const r = await fetch(url, {mode:'cors'});
      if(!r.ok) throw new Error(await r.text());
      return r.json();
    }

    let lastZip = '';
    function setPlaceLine(z, place, st){
      $('#placeLine').innerText = z ? `${z} ‚Äî ${place||''}${place?', ':''}${st||''}` : '';
    }

    document.querySelectorAll('[data-open]').forEach(b=>{
      b.addEventListener('click', ()=> $('#'+b.dataset.open).classList.add('open'));
    });
    document.querySelectorAll('[data-close]').forEach(b=>{
      b.addEventListener('click', ()=> $('#'+b.dataset.close).classList.remove('open'));
    });
    document.querySelectorAll('.modal').forEach(m=>{
      m.addEventListener('click', (e)=>{ if(e.target===m) m.classList.remove('open');});
    });

    $('#btnClear').addEventListener('click', ()=>{
      $('#zipInput').value='';
      lastZip='';
      setPlaceLine('','','');
      $('#officials').innerHTML='';
      $('#weatherList').innerHTML='';
      $('#fedElection').innerText='Next Federal: ‚Äî';
    });

    $('#btnCopyLink').addEventListener('click', ()=>{
      const z = $('#zipInput').value.trim();
      const url = z ? `${location.origin}${location.pathname}?zip=${encodeURIComponent(z)}` : `${location.origin}${location.pathname}`;
      copy(url);
    });

    $('#btnSearch').addEventListener('click', ()=> doSearch($('#zipInput').value.trim()));
    $('#zipInput').addEventListener('keydown', (e)=>{ if(e.key==='Enter') $('#btnSearch').click(); });

    $('#btnLocate').addEventListener('click', async ()=>{
      if(!navigator.geolocation){ alert('Geolocation not available'); return; }
      navigator.geolocation.getCurrentPosition(async pos=>{
        try{
          const rev = await fetchJson('/reverse-zip', {lat:pos.coords.latitude, lon:pos.coords.longitude});
          if(!rev.zip){ alert('Could not resolve ZIP from your location.'); return; }
          $('#zipInput').value = rev.zip;
          setPlaceLine(rev.zip, rev.place, rev.state);
          await doSearch(rev.zip);
        }catch(e){ alert('Could not resolve ZIP from your location.'); }
      }, err=>{
        alert('Location permission denied or unavailable.');
      }, {enableHighAccuracy:true, timeout:10000});
    });

    async function doSearch(zip){
      if(!zip){ alert('Enter a ZIP'); return; }
      lastZip = zip;

      try{
        const info = await fetchJson('/zipinfo', {zip});
        setPlaceLine(zip, info.place||'', info.state||'');
      }catch(e){ setPlaceLine(zip, '', ''); }

      $('#openLocalNews').href = `https://news.google.com/search?q=${encodeURIComponent(zip)}&hl=en-US&gl=US&ceid=US:en`;
      $('#openWorldNews').href = `https://news.google.com/topstories?hl=en-US&gl=US&ceid=US:en`;
      $('#trafficLink').href    = `https://www.google.com/maps/@?api=1&map_action=map&layer=traffic&query=${encodeURIComponent(zip)}`;

      $('#concernPotholes').href = `https://www.google.com/search?q=${encodeURIComponent(zip+' report pothole')}`;
      $('#concernTrash').href    = `https://www.google.com/search?q=${encodeURIComponent(zip+' report trash pickup')}`;
      $('#concernLights').href   = `https://www.google.com/search?q=${encodeURIComponent(zip+' report street light')}`;

      $('#howToVote').href   = 'https://www.usa.gov/how-to-vote';
      $('#registerVote').href= 'https://www.vote.gov/';
      $('#findOffice').href  = 'https://www.usa.gov/election-office';

      await Promise.all([loadOfficials(zip), loadWeather(zip), loadElections(zip)]);
    }

    async function loadOfficials(zip){
      const box = $('#officials'); box.innerHTML = '';
      try{
        const data = await fetchJson('/officials', {zip});
        if(!data.officials || data.officials.length===0){
          box.append(el('div', {className:'note', innerText:'Enter a ZIP to load officials‚Ä¶'}));
          return;
        }
        data.officials.forEach(o=>{
          const phone = (o.phones && o.phones[0]) ? (o.phones[0]) : '';
          const row = el('div', {className:'item'}, [
            el('div', {className:'title', innerText: o.name || '‚Äî'}),
            el('div', {className:'note', innerText: `${o.office || ''}${o.party ? ' ‚Äî '+o.party : ''}`}),
            el('div', {className:'row'}, [
              (o.urls && o.urls[0]) ? el('a', {href:o.urls[0], target:'_blank', rel:'noopener', className:'pill'}, 'Website') : null,
              phone ? el('a', {href:`tel:${phone.replace(/[^\d]/g,'')}`, className:'pill'}, 'Call') : null
            ])
          ]);
          box.append(row);
        });
      }catch(e){
        box.append(el('div',{className:'note',innerText:'Could not load officials.'}));
      }
    }

    async function loadWeather(zip){
      const wxBox = $('#weatherList'); wxBox.innerHTML = '';
      try{
        const wx = await fetchJson('/weather', {zip});
        const days = (wx.days || []).slice(0,7);
        if(days.length===0){
          wxBox.append(el('div',{className:'note',innerText:'Weather forecast unavailable.'}));
          return;
        }
        days.forEach(d=>{
          const hi = (d.max!=null)? Math.round(d.max) : '‚Äî';
          const lo = (d.min!=null)? Math.round(d.min) : '‚Äî';
          wxBox.append(el('div',{className:'item'},[
            el('div',{className:'title',innerText:`${d.date} ‚Äî ${d.summary}`}),
            el('div',{className:'note',innerText:`High ${hi}¬∞  ‚Ä¢  Low ${lo}¬∞`})
          ]));
        });
      }catch(e){
        wxBox.append(el('div',{className:'note',innerText:'Weather unavailable.'}));
      }
    }

    async function loadElections(zip){
      try{
        const data = await fetchJson('/elections', {zip});
        $('#fedElection').innerText = `Next Federal: ${data?.next?.federal || '‚Äî'}`;
      }catch(e){
        $('#fedElection').innerText = 'Next Federal: ‚Äî';
      }
    }

    (function boot(){
      const qp = new URLSearchParams(location.search);
      const startZip = qp.get('zip') || '';
      if(startZip){
        $('#zipInput').value = startZip;
        doSearch(startZip);
      }
    })();
  </script>
</body>
</html>
