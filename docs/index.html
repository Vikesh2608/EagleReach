<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EagleReach</title>

  <!-- ===== Styles (embedded) ===== -->
  <style>
    :root{
      --bg:#ffffff;
      --card:#ffffff;
      --ink:#0e1628;
      --muted:#6b7280;
      --blue:#1b5fd1;
      --blue-600:#174fb0;
      --ghost:#e8eefb;
      --dark:#121a2c;
      --chip:#eef2f7;
      --border:#e5e7eb;
      --shadow:0 6px 18px rgba(16, 24, 40, .06);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--ink);
      font:15px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
    }
    /* Header */
    .topbar{
      position:sticky; top:0; z-index:10;
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 18px; background:#0f3f8c; color:#fff; box-shadow:var(--shadow);
    }
    .brand{display:flex; align-items:center; gap:10px; font-weight:700}
    .flag{font-size:20px}
    .name{font-size:18px}
    .nav a{color:#fff; text-decoration:none; margin-left:18px; opacity:.95}
    .nav a:hover{opacity:1; text-decoration:underline}
    .subhead{ text-align:center; font-size:12px; color:#d7e3ff; background:#0f3f8c; padding-bottom:10px; }

    /* Layout */
    .container{max-width:1080px; margin:22px auto; padding:0 12px}
    .grid{display:grid; grid-template-columns: 1fr 1fr; gap:18px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}

    .card{
      background:var(--card); border:1px solid var(--border); border-radius:14px;
      padding:16px; box-shadow:var(--shadow);
    }
    .card h3{margin:0 0 12px 0}

    /* Inputs / buttons */
    .zip-row{display:flex; gap:10px; flex-wrap:wrap}
    #zipInput{
      flex:1 1 260px; min-width:260px;
      padding:11px 12px; border:1px solid var(--border); border-radius:10px; font-size:16px;
    }
    .btn{
      border:none; border-radius:10px; padding:10px 14px; cursor:pointer;
      text-decoration:none; display:inline-flex; align-items:center; justify-content:center;
      font-weight:600; color:#fff; transition:all .1s ease;
    }
    .btn.primary{background:var(--blue)}
    .btn.primary:hover{background:var(--blue-600)}
    .btn.ghost{background:var(--ghost); color:#0f2b64}
    .btn.dark{background:#18233b}
    .btn.block{width:100%}
    .row{display:flex; align-items:center}
    .wrap{flex-wrap:wrap}
    .gap{gap:10px}
    .stack{display:flex; flex-direction:column; gap:10px}
    .muted{color:var(--muted); margin-top:8px}
    .zip-actions{margin-top:8px; display:flex; gap:10px; flex-wrap:wrap}

    /* Chips & pills */
    .chip{background:var(--chip); border-radius:999px; padding:8px 14px; color:#1d2a45; text-decoration:none}
    .pill{color:#fff; text-decoration:none; border-radius:999px; padding:8px 14px}
    .red{background:#d9373f}
    .purple{background:#7526d9}
    .green{background:#0f8a3b}
    .blue{background:#1c4fd7}
    .orange{background:#d47500}
    .amber{background:#d18f00}

    /* Officials */
    #officials .official{
      border:1px solid var(--border); border-radius:12px; padding:12px; margin-bottom:10px;
    }
    .official .title{font-size:12px; color:var(--muted); margin-bottom:4px}
    .official .name{font-weight:700; margin-bottom:8px}
    .official .row{gap:8px}

    /* Weather items */
    .weather-item{
      border:1px solid var(--border); border-radius:10px; padding:10px; margin-bottom:8px; background:#fff;
    }

    /* Modal */
    .modal{border:none; border-radius:16px; padding:0; width:min(760px, 92%)}
    .modal::backdrop{background:rgba(0,0,0,.45)}
    .modal-body{padding:20px; position:relative}
    .close{
      position:absolute; right:12px; top:10px; background:#f2f4f8; border:none; border-radius:8px; padding:6px 10px; cursor:pointer
    }
    .footer{color:#8a93a7; text-align:center; padding:28px 8px}
  </style>
</head>
<body>
  <!-- Header -->
  <header class="topbar">
    <div class="brand">
      <span class="flag">üá∫üá∏</span>
      <span class="name">EagleReach</span>
    </div>
    <nav class="nav">
      <a href="#" data-open="about">About</a>
      <a href="#" data-open="founder">Founder</a>
      <a href="#" data-open="contact">Contact</a>
      <a href="#" data-open="feedback">Feedback</a>
    </nav>
  </header>
  <div class="subhead">Civic info, fast &amp; free ‚Äî built for everyone.</div>

  <!-- Main container -->
  <main class="container">
    <!-- ZIP/Search -->
    <section class="card">
      <h3>Enter ZIP</h3>
      <div class="zip-row">
        <input id="zipInput" inputmode="numeric" pattern="[0-9]*" maxlength="5" placeholder="ZIP (e.g., 45220)" />
        <button id="btnLocate" class="btn ghost">üìç Use my location</button>
        <button id="btnSearch" class="btn primary">üîé Search</button>
      </div>
      <div class="zip-actions">
        <button id="btnCopy" class="btn ghost">üîó Copy Share Link</button>
        <button id="btnClear" class="btn ghost">üßπ Clear history</button>
      </div>
      <div id="placeLabel" class="muted"></div>
    </section>

    <div class="grid">
      <!-- Representatives -->
      <section class="card">
        <h3>Elected Representatives</h3>
        <div id="officials"></div>
        <div class="sources">Sources: Zippopotam (ZIP), WhoIsMyRepresentative (House), GovTrack (Senate, fallback), Open-Meteo (weather).</div>
      </section>

      <!-- Voter info -->
      <aside class="card">
        <h3>Voter Info &amp; Education</h3>
        <div class="stack">
          <a class="btn primary block" target="_blank" href="https://www.usa.gov/how-to-vote">How to vote (USA.gov)</a>
          <a class="btn primary block" target="_blank" href="https://vote.gov/">Register to vote</a>
          <a class="btn primary block" target="_blank" href="https://www.usa.gov/election-office">Find your Election Office</a>
        </div>
      </aside>
    </div>

    <div class="grid">
      <!-- News -->
      <section class="card">
        <h3>News</h3>
        <p class="muted">Opens news in a new tab.</p>
        <div class="row gap">
          <a id="openLocalNews" class="btn dark" target="_blank" rel="noopener">Open Local News</a>
          <a id="openWorldNews" class="btn dark" target="_blank" rel="noopener">World News</a>
        </div>
      </section>

      <!-- Elections -->
      <aside class="card">
        <h3>Upcoming Elections</h3>
        <div id="elections"></div>
      </aside>
    </div>

    <div class="grid">
      <!-- Traffic -->
      <section class="card">
        <h3>Traffic</h3>
        <p class="muted">Open live traffic for your area in Google Maps.</p>
        <a id="openTraffic" class="btn primary" target="_blank" rel="noopener">Open Traffic Map</a>
      </section>

      <!-- Weather -->
      <aside class="card">
        <h3>Local Weather (7-day)</h3>
        <div id="weather"></div>
      </aside>
    </div>

    <section class="card">
      <h3>Raise a Concern</h3>
      <p class="muted">Report city issues (311), contact your city hall, or write to your representatives.</p>
      <div class="row wrap gap">
        <a class="chip" id="concernPotholes" target="_blank">Potholes</a>
        <a class="chip" id="concernTrash" target="_blank">Trash</a>
        <a class="chip" id="concernLights" target="_blank">Street lights</a>
      </div>
    </section>

    <section class="card">
      <h3>Emergency</h3>
      <div class="row wrap gap">
        <a class="pill red" href="tel:911">911 ‚Äî Emergency</a>
        <a class="pill purple" href="tel:988">988 ‚Äî Suicide &amp; Crisis</a>
        <a class="pill green" href="tel:211">211 ‚Äî Community Services</a>
        <a class="pill blue" href="tel:311">311 ‚Äî City Services</a>
        <a class="pill orange" href="tel:811">811 ‚Äî Before You Dig</a>
        <a class="pill amber" href="tel:18002221222">Poison Control</a>
      </div>
    </section>

    <footer class="footer">¬© 2025 EagleReach</footer>
  </main>

  <!-- Modals -->
  <dialog id="aboutModal" class="modal">
    <div class="modal-body">
      <button class="close" data-close>√ó</button>
      <h2>About EagleReach</h2>
      <p>
        EagleReach is a civic information platform designed to make government data accessible,
        transparent, and useful for everyone. The platform provides U.S. residents with quick access
        to their elected representatives, voter resources, local weather updates, election information,
        and civic services ‚Äî all without requiring a login.
      </p>
      <p>
        Built with a passion for technology and community service, EagleReach empowers individuals
        to engage more directly with their democracy, fostering awareness and participation in everyday civic life.
      </p>
    </div>
  </dialog>

  <dialog id="founderModal" class="modal">
    <div class="modal-body">
      <button class="close" data-close>√ó</button>
      <h2>Founder ‚Äî Vikesh Sagar Bairam</h2>
      <p>
        Vikesh Sagar Bairam is a technology professional with expertise in <strong>Data Engineering,
        Cloud Platforms, DevOps, and AI/ML solutions</strong>. He holds a <strong>Master‚Äôs in Information Systems &amp; Management</strong>
        from the <strong>University of Illinois, Springfield</strong>, along with Bachelor‚Äôs degrees in <strong>Psychology and Arts</strong>
        (Osmania University) and <strong>Computer Science</strong>.
      </p>
      <p>
        His career spans multiple industries, having served as a <strong>Data Specialist / Analyst</strong> at <strong>Jabil</strong>,
        <strong> Data Analyst</strong> at <strong>S&amp;P Global (IHS Markit)</strong>, <strong>DevOps Engineer</strong> at <strong>Techtate Systems</strong>,
        <strong> DevOps Intern</strong> at <strong>Surfaces by Pacific</strong>, and <strong>Supply Chain Specialist</strong> at <strong>Auscomp Computers</strong>.
        He is a <strong>Google Cloud Certified Professional Data Engineer</strong> with experience across AWS and GCP.
      </p>
      <p>
        Passionate about community service and civic technology, Vikesh created EagleReach to make civic information
        easier to access ‚Äî building tools that optimize processes, delight end-users, and deliver meaningful impact.
      </p>
    </div>
  </dialog>

  <dialog id="contactModal" class="modal">
    <div class="modal-body">
      <button class="close" data-close>√ó</button>
      <h2>Contact</h2>
      <p><a class="btn dark block" target="_blank" href="https://www.linkedin.com/in/vikesh-bairam-219769258/">LinkedIn</a></p>
      <p><a class="btn dark block" target="_blank" href="https://github.com/vikesh2608">GitHub</a></p>
      <p><a class="btn primary block" href="mailto:vikebairam@gmail.com?subject=EagleReach%20Feedback&body=Hi%20Vikesh,%0D%0A%0D%0A">Email: vikebairam@gmail.com</a></p>
    </div>
  </dialog>

  <dialog id="feedbackModal" class="modal">
    <div class="modal-body">
      <button class="close" data-close>√ó</button>
      <h2>Feedback</h2>
      <p>We‚Äôd love your thoughts, ideas, and bug reports.</p>
      <a class="btn primary block" href="mailto:vikebairam@gmail.com?subject=EagleReach%20Feedback&body=Hi%20Vikesh,%0D%0A%0D%0A">Email feedback</a>
    </div>
  </dialog>

  <!-- ===== App JS (embedded) ===== -->
  <script>
    // ---- CONFIG ----
    const API_BASE = "https://eaglereach.fly.dev"; // change if your backend URL differs

    // Elements
    const zipInput = document.getElementById("zipInput");
    const btnSearch = document.getElementById("btnSearch");
    const btnLocate = document.getElementById("btnLocate");
    const btnCopy = document.getElementById("btnCopy");
    const btnClear = document.getElementById("btnClear");

    const placeLabel = document.getElementById("placeLabel");
    const officialsEl = document.getElementById("officials");
    const weatherEl = document.getElementById("weather");
    const electionsEl = document.getElementById("elections");

    const openLocalNews = document.getElementById("openLocalNews");
    const openWorldNews = document.getElementById("openWorldNews");
    const openTraffic = document.getElementById("openTraffic");

    const concernPotholes = document.getElementById("concernPotholes");
    const concernTrash = document.getElementById("concernTrash");
    const concernLights = document.getElementById("concernLights");

    // Modals
    const modals = {
      about: document.getElementById("aboutModal"),
      founder: document.getElementById("founderModal"),
      contact: document.getElementById("contactModal"),
      feedback: document.getElementById("feedbackModal"),
    };
    document.querySelectorAll('[data-open]').forEach(a=>{
      a.addEventListener('click', e=>{
        e.preventDefault();
        modals[a.dataset.open]?.showModal();
      });
    });
    document.querySelectorAll('[data-close]').forEach(btn=>{
      btn.addEventListener('click', ()=> btn.closest('dialog').close());
    });

    // Utilities
    const ok = (r)=> { if(!r.ok) throw new Error(\`HTTP \${r.status}\`); return r; };
    const j = (r)=> r.json();

    function alertMsg(msg){
      if (window.matchMedia("(max-width: 900px)").matches) {
        alert(msg);
      } else {
        const div = document.createElement('div');
        div.textContent = msg;
        div.style.cssText="position:fixed;bottom:16px;left:50%;transform:translateX(-50%);background:#0f3f8c;color:#fff;padding:10px 14px;border-radius:10px;z-index:99;box-shadow:0 8px 18px rgba(0,0,0,.25)";
        document.body.appendChild(div);
        setTimeout(()=>div.remove(), 2400);
      }
    }

    function setPlaceLabel({zip, place, state}){
      placeLabel.textContent = zip ? \`\${zip} ‚Äî \${place || ""}\${place ? ", " : ""}\${state || ""}\` : "";
    }

    // Renderers
    function renderOfficials(payload){
      officialsEl.innerHTML = "";
      if (!payload || !payload.officials || !payload.officials.length){
        officialsEl.innerHTML = \`<div class="muted">No officials found for this ZIP right now.</div>\`;
        return;
      }

      payload.officials.forEach(o=>{
        const card = document.createElement("div");
        card.className = "official";

        const title = document.createElement("div");
        title.className = "title";
        title.textContent = o.office || "Official";

        const name = document.createElement("div");
        name.className = "name";
        name.textContent = \`\${o.name || "Unknown"}\${o.party ? \` ‚Äî \${o.party}\` : ""}\`;

        const row = document.createElement("div");
        row.className = "row";

        if (o.urls && o.urls.length){
          const a = document.createElement("a");
          a.className = "btn ghost";
          a.href = o.urls[0];
          a.target = "_blank";
          a.rel = "noopener";
          a.textContent = "Website";
          row.appendChild(a);
        }

        if (o.phones && o.phones.length){
          const call = document.createElement("a");
          call.className = "btn ghost";
          call.href = \`tel:\${o.phones[0].replace(/[^0-9+]/g,"")}\`;
          call.textContent = "Call";
          row.appendChild(call);
        }

        card.appendChild(title);
        card.appendChild(name);
        card.appendChild(row);
        officialsEl.appendChild(card);
      });
    }

    function renderWeather(payload){
      weatherEl.innerHTML = "";
      const days = (payload && payload.days) || [];
      if (!days.length){
        weatherEl.innerHTML = \`<div class="muted">Weather unavailable for this ZIP right now.</div>\`;
        return;
      }
      days.forEach(d=>{
        const div = document.createElement("div");
        div.className = "weather-item";
        div.textContent = \`\${d.date}: \${d.summary} (High \${d.max}¬∞ / Low \${d.min}¬∞)\`;
        weatherEl.appendChild(div);
      });
    }

    function renderElections(payload){
      electionsEl.innerHTML = "";
      const next = payload && payload.next && payload.next.federal;
      const div = document.createElement("div");
      div.className = "chip";
      div.textContent = \`Next Federal: \${next || "‚Äî"}\`;
      electionsEl.appendChild(div);
    }

    // Load everything for a ZIP
    async function loadForZip(zip){
      if (!/^\\d{5}$/.test(zip)) {
        alertMsg("Please enter a valid 5-digit ZIP.");
        return;
      }

      // Label (city/state) + helpful links
      try {
        const z = await fetch(\`\${API_BASE}/zipinfo?zip=\${zip}\`).then(ok).then(j);
        setPlaceLabel({ zip: z.zip, place: z.place, state: z.state });
        openLocalNews.href = \`https://news.google.com/search?q=\${encodeURIComponent(z.place || zip)}&hl=en-US&gl=US&ceid=US:en\`;
        openWorldNews.href = \`https://news.google.com/topstories?hl=en-US&gl=US&ceid=US:en\`;
        openTraffic.href = \`https://www.google.com/maps/@?api=1&map_action=map&layer=traff&query=\${encodeURIComponent(z.place || zip)}\`;
        concernPotholes.href = \`https://www.google.com/search?q=\${encodeURIComponent((z.place||"")+" "+(z.state||"")+" pothole report")}\`;
        concernTrash.href = \`https://www.google.com/search?q=\${encodeURIComponent((z.place||"")+" "+(z.state||"")+" bulk trash pickup")}\`;
        concernLights.href = \`https://www.google.com/search?q=\${encodeURIComponent((z.place||"")+" "+(z.state||"")+" street light report")}\`;
      } catch (e) {
        setPlaceLabel({ zip });
      }

      // Officials
      try{
        const officials = await fetch(\`\${API_BASE}/officials?zip=\${zip}\`).then(ok).then(j);
        renderOfficials(officials);
      }catch(e){
        renderOfficials(null);
      }

      // Weather
      try{
        const wx = await fetch(\`\${API_BASE}/weather?zip=\${zip}\`).then(ok).then(j);
        renderWeather(wx);
      }catch(e){
        renderWeather(null);
      }

      // Elections
      try{
        const el = await fetch(\`\${API_BASE}/elections?zip=\${zip}\`).then(ok).then(j);
        renderElections(el);
      }catch(e){
        renderElections(null);
      }

      // write zip to URL
      const url = new URL(location.href);
      url.searchParams.set("zip", zip);
      history.replaceState({}, "", url.toString());
    }

    // Geolocation ‚Üí reverse ZIP
    async function useMyLocation(){
      if (!("geolocation" in navigator)){
        alertMsg("Location not supported on this device.");
        return;
      }
      navigator.geolocation.getCurrentPosition(async pos=>{
        try{
          const { latitude, longitude } = pos.coords;
          const rev = await fetch(\`\${API_BASE}/reverse-zip?lat=\${latitude}&lon=\${longitude}\`).then(ok).then(j);
          const zip = rev.zip;
          if (!zip) throw new Error("No ZIP for location.");
          zipInput.value = zip;
          await loadForZip(zip);
        }catch(e){
          alertMsg("Could not resolve ZIP from your location. You can type a ZIP manually.");
        }
      }, err=>{
        alertMsg("Permission denied or location unavailable.");
      }, { enableHighAccuracy:true, timeout:12000, maximumAge:0 });
    }

    // Events
    btnSearch.addEventListener("click", ()=> loadForZip(zipInput.value.trim()));
    btnLocate.addEventListener("click", useMyLocation);
    btnCopy.addEventListener("click", ()=>{
      const url = new URL(location.href);
      const zip = zipInput.value.trim();
      if (/^\\d{5}$/.test(zip)) url.searchParams.set("zip", zip);
      navigator.clipboard.writeText(url.toString()).then(()=> alertMsg("Share link copied!"));
    });
    btnClear.addEventListener("click", ()=>{
      zipInput.value = "";
      placeLabel.textContent = "";
      history.replaceState({}, "", location.pathname);
      officialsEl.innerHTML = "";
      weatherEl.innerHTML = "";
      electionsEl.innerHTML = "";
    });

    // Auto-search when user types exactly 5 digits
    zipInput.addEventListener("input", ()=>{
      const v = zipInput.value.replace(/\\D/g,"").slice(0,5);
      if (zipInput.value !== v) zipInput.value = v;
      if (v.length === 5) loadForZip(v);
    });

    // Boot from URL ?zip=
    (function init(){
      const url = new URL(location.href);
      const z = (url.searchParams.get("zip") || "").trim();
      if (/^\\d{5}$/.test(z)) {
        zipInput.value = z;
        loadForZip(z);
      }
    })();
  </script>
</body>
</html>
