cat > frontend/index.html <<'HTML'
<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>EagleReach</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>.flag{font-size:1.6rem;line-height:1}</style>
</head>
<body class="bg-gray-100 text-gray-900 min-h-screen">
  <nav class="w-full py-3 bg-white/90 backdrop-blur border-b">
    <div class="max-w-6xl mx-auto flex items-center justify-between px-4">
      <a href="#top" class="font-semibold text-lg hover:opacity-90 flex items-center gap-2">
        <span class="flag">ğŸ‡ºğŸ‡¸</span><span>EagleReach</span>
      </a>
      <div class="flex items-center gap-6">
        <a href="#top" class="text-sm text-gray-700 hover:text-blue-700">Home</a>
        <button id="aboutBtn" class="text-sm text-gray-700 hover:text-blue-700">About</button>
        <button id="contactBtn" class="text-sm text-gray-700 hover:text-blue-700">Contact</button>
      </div>
    </div>
  </nav>
  <div id="top"></div>

  <header class="max-w-6xl mx-auto text-center px-4 mt-6">
    <h1 class="text-4xl font-bold flex items-center justify-center gap-3">
      <span class="flag">ğŸ‡ºğŸ‡¸</span><span>US EagleReach</span>
    </h1>
    <p class="text-gray-600 mt-2">Enter your ZIP code to see representatives, live local info, BMV/DMV offices, and upcoming elections.</p>
  </header>

  <section class="max-w-3xl mx-auto mt-6 px-4" aria-label="ZIP search">
    <div class="flex items-center gap-3">
      <input id="zipInput" maxlength="5" inputmode="numeric" aria-label="ZIP code"
             placeholder="62704"
             class="border rounded-lg px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-500"/>
      <button id="locBtn" class="border px-3 py-2 rounded-lg hover:bg-gray-50">Use my location</button>
      <button id="searchBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-5 py-2 rounded-lg">Search</button>
    </div>
    <div class="flex items-center gap-2 mt-2 flex-wrap">
      <button id="clearHistBtn" class="text-xs border px-2 py-1 rounded-md hover:bg-gray-50">Clear history</button>
      <button id="shareBtn" class="text-xs border px-2 py-1 rounded-md hover:bg-gray-50">Copy Share Link</button>
      <span id="msg" class="text-sm text-gray-600"></span>
    </div>
    <div id="history" class="mt-3 flex gap-2 flex-wrap"></div>
  </section>

  <main class="max-w-6xl mx-auto mt-8 px-4 grid lg:grid-cols-3 gap-6">
    <!-- LEFT COLUMN -->
    <div class="space-y-6">
      <section class="bg-white rounded-2xl shadow p-5">
        <div class="flex items-center justify-between">
          <h2 class="text-xl font-semibold">Elected Representatives</h2>
          <div class="flex gap-2">
            <button id="copyEmailsBtn" class="border text-sm px-3 py-2 rounded-md hover:bg-gray-50">Copy Emails</button>
            <button id="copyTextBtn" class="border text-sm px-3 py-2 rounded-md hover:bg-gray-50">Copy Officials</button>
            <button id="emailBtn" class="bg-purple-600 hover:bg-purple-700 text-white text-sm px-3 py-2 rounded-md">Generate Email</button>
          </div>
        </div>
        <p class="text-xs text-gray-500 mt-1">Updated at <span id="updatedAt">â€”</span></p>
        <ul id="officialsList" class="mt-4 space-y-3"></ul>
        <p class="text-xs text-gray-500 mt-3">Sources: GovTrack (Congress), Wikidata (Mayor), FCC, Zippopotam.</p>
      </section>

      <section class="bg-white rounded-2xl shadow p-5">
        <h3 class="font-semibold mb-2">Raise a Concern</h3>
        <p class="text-gray-600 text-sm">Report issues to your city or officials. These templates open your mail app with a prefilled message.</p>
        <div class="mt-3 flex gap-3 flex-wrap">
          <button data-issue="Pothole on my street" class="border px-3 py-2 rounded hover:bg-gray-50">Report Pothole</button>
          <button data-issue="Trash collection missed" class="border px-3 py-2 rounded hover:bg-gray-50">Missed Trash</button>
          <button data-issue="Streetlight not working" class="border px-3 py-2 rounded hover:bg-gray-50">Streetlight Out</button>
          <button data-issue="Public safety concern" class="border px-3 py-2 rounded hover:bg-gray-50">Safety Concern</button>
        </div>
      </section>
    </div>

    <!-- MIDDLE COLUMN -->
    <div class="space-y-6">
      <section class="bg-white rounded-2xl shadow p-5">
        <h2 class="text-xl font-semibold mb-2">Live in Your Area</h2>
        <div>
          <h4 class="font-medium">âš ï¸ Alerts</h4>
          <ul id="alertsList" class="mt-2 space-y-2 text-sm"></ul>
          <p id="noAlerts" class="text-gray-500 text-sm hidden">No active alerts.</p>
        </div>
        <div class="mt-4">
          <h4 class="font-medium">ğŸŒ Recent Earthquakes (200 km)</h4>
          <ul id="quakesList" class="mt-2 space-y-2 text-sm"></ul>
          <p id="noQuakes" class="text-gray-500 text-sm hidden">No significant earthquakes in the last 7 days.</p>
        </div>
      </section>

      <section class="bg-white rounded-2xl shadow p-5">
        <h2 class="text-xl font-semibold mb-2">Upcoming Elections</h2>
        <div class="text-gray-800">
          <p><span class="font-semibold">Next Federal:</span> <span id="electionDate">â€”</span></p>
          <p class="text-sm text-gray-600 mt-1">State primary dates coming soon (open data, state SoS sources).</p>
        </div>
      </section>
    </div>

    <!-- RIGHT COLUMN -->
    <div class="space-y-6">
      <section class="bg-white rounded-2xl shadow p-5">
        <h2 class="text-xl font-semibold mb-2">BMV/DMV Near You</h2>
        <ul id="bmvList" class="space-y-3"></ul>
        <p id="noBmv" class="text-gray-500 text-sm hidden">No nearby BMV/DMV offices found within 25 km.</p>
      </section>

      <section class="bg-white rounded-2xl shadow p-5">
        <h3 class="font-semibold mb-2">Local Resources</h3>
        <div class="mt-3 flex gap-3">
          <a id="newsBtn" target="_blank" rel="noopener" class="inline-block bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg" href="https://news.google.com/">Open Local News</a>
          <a id="govPortalBtn" target="_blank" rel="noopener" class="inline-block border px-4 py-2 rounded-lg hover:bg-gray-50" href="https://www.usa.gov/">USA.gov</a>
        </div>
      </section>
    </div>
  </main>

  <footer class="max-w-6xl mx-auto px-4 py-10 text-center text-sm text-gray-500">
    Â© 2025 EagleReach by Vikesh Sagar Bairam. All rights reserved.
  </footer>

  <!-- About Modal -->
  <div id="aboutModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div class="bg-white max-w-2xl w-[92%] md:w-[700px] rounded-2xl shadow-xl p-6 relative">
      <button data-close="about" class="absolute right-3 top-3 text-gray-500 hover:text-gray-800">âœ•</button>
      <h2 class="text-2xl font-bold mb-3">About EagleReach</h2>
      <p class="text-gray-700 mb-2">EagleReach is an <strong>AIâ€‘powered civic engagement platform</strong> I created to help U.S. residents reach their government in seconds. Enter your ZIP to find your representatives, see live local information, locate nearby BMV/DMV offices, and raise concerns like potholes or trash issues.</p>
      <blockquote class="italic text-gray-700 border-l-4 border-blue-500 pl-3 my-3">â€œGovernment of the people, by the people, for the people, shall not perish from the Earth.â€ â€” Abraham Lincoln</blockquote>
      <h3 class="font-semibold mt-4 mb-1">About Me</h3>
      <p class="text-gray-700">Iâ€™m <strong>Vikesh Sagar Bairam</strong> â€” <em>AI/ML & Data Engineer | DevOps Specialist | Research Professional | Creator of EagleReach</em>. Masterâ€™s in Information Systems & Management (AI/ML, Generative AI); dual Bachelorâ€™s in Psychology and Computer Science. Currently at Jabil; previously Surfaces by Pacific.</p>
      <p class="text-xs text-gray-500 mt-4">Open data sources: GovTrack, FCC, Zippopotam, Wikidata, NWS, USGS, OpenStreetMap.</p>
    </div>
  </div>

  <!-- Contact Modal -->
  <div id="contactModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
    <div class="bg-white max-w-md w-[92%] rounded-2xl shadow-xl p-6 relative">
      <button data-close="contact" class="absolute right-3 top-3 text-gray-500 hover:text-gray-800">âœ•</button>
      <h2 class="text-2xl font-bold mb-3">Contact</h2>
      <div class="space-y-3">
        <a class="block border rounded-lg p-3 hover:bg-gray-50" href="mailto:vikebairam@gmail.com?subject=EagleReach%20Inquiry">âœ‰ï¸ Email â€” vikebairam@gmail.com</a>
        <a class="block border rounded-lg p-3 hover:bg-gray-50" href="https://www.linkedin.com/in/vikesh-bairam-219769258/" target="_blank" rel="noopener">ğŸ”— LinkedIn â€” vikesh-bairam-219769258</a>
        <a class="block border rounded-lg p-3 hover:bg-gray-50" href="https://github.com/Vikesh2608" target="_blank" rel="noopener">ğŸ’» GitHub â€” @Vikesh2608</a>
      </div>
    </div>
  </div>

  <script>
    const BACKEND_BASE = "https://eaglereach-1.onrender.com";
    const zipInput = document.getElementById("zipInput");
    const searchBtn = document.getElementById("searchBtn");
    const locBtn = document.getElementById("locBtn");
    const listEl = document.getElementById("officialsList");
    const msgEl = document.getElementById("msg");
    const aboutBtn = document.getElementById("aboutBtn");
    const contactBtn = document.getElementById("contactBtn");
    const aboutModal = document.getElementById("aboutModal");
    const contactModal = document.getElementById("contactModal");
    const historyEl = document.getElementById("history");
    const clearHistBtn = document.getElementById("clearHistBtn");
    const shareBtn = document.getElementById("shareBtn");
    const newsBtn = document.getElementById("newsBtn");
    const electionDateEl = document.getElementById("electionDate");
    const updatedAtEl = document.getElementById("updatedAt");
    const copyEmailsBtn = document.getElementById("copyEmailsBtn");
    const copyTextBtn = document.getElementById("copyTextBtn");
    const emailBtn = document.getElementById("emailBtn");
    const alertsList = document.getElementById("alertsList");
    const quakesList = document.getElementById("quakesList");
    const bmvList = document.getElementById("bmvList");
    const noAlerts = document.getElementById("noAlerts");
    const noQuakes = document.getElementById("noQuakes");
    const noBmv = document.getElementById("noBmv");

    function setMsg(t, cls="text-gray-600"){ msgEl.className="text-sm "+cls; msgEl.textContent=t; }
    const esc = (s="") => String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
    const link = (url) => `<a class="text-blue-600 hover:underline break-all" href="${esc(url)}" target="_blank" rel="noopener">${esc(url.replace(/^https?:\/\//,''))}</a>`;

    function row(o={}){
      const name=o.name||"N/A", office=o.office||"Official", party=o.party?` â€” ${o.party}`:"";
      const url=(o.urls&&o.urls[0])||"", phone=(o.phones&&o.phones[0])||"", email=(o.emails&&o.emails[0])||"";
      return `<li class="border rounded-xl p-4 bg-white">
        <p class="font-semibold">${esc(name)} â€” <span class="text-gray-600">${esc(office)}</span>${esc(party)}</p>
        ${url? `<p class="mt-1">ğŸ”— ${link(url)}</p>`:""}
        ${phone? `<p class="mt-1">ğŸ“ ${esc(phone)}</p>`:""}
        ${email? `<p class="mt-1">âœ‰ï¸ ${esc(email)}</p>`:""}
      </li>`;
    }

    function renderOfficials(data){
      const officials = Array.isArray(data?.officials)?data.officials:[];
      listEl.innerHTML = officials.length ? officials.map(row).join("")
        : `<li class="text-gray-600">No officials found for this ZIP.</li>`;
      updatedAtEl.textContent = data?.generated_at || "â€”";
    }

    function nextGeneralElectionDate(){
      const now=new Date();
      for(let y=now.getFullYear(); y<=now.getFullYear()+1; y++){
        const nov1=new Date(y,10,1); const dow=nov1.getDay();
        const firstMon=new Date(y,10,(dow===1?1:((8-dow)%7))); const tue=new Date(firstMon); tue.setDate(firstMon.getDate()+1);
        if(tue>now) return tue;
      } return null;
    }
    const fmt=d=>d?d.toLocaleDateString(undefined,{year:"numeric",month:"long",day:"numeric"}):"â€”";

    function getHistory(){ try{return JSON.parse(localStorage.getItem("zip_history")||"[]")}catch{return[]} }
    function setHistory(a){ try{localStorage.setItem("zip_history",JSON.stringify(a.slice(0,5)))}catch{} }
    function pushHistory(zip,label){ let h=getHistory().filter(z=>z!==zip); h.unshift(zip); setHistory(h); renderHistory(label); }
    function renderHistory(label){
      const h=getHistory();
      historyEl.innerHTML=h.map(z=>`<button class="text-xs border px-2 py-1 rounded hover:bg-gray-50" data-zip="${esc(z)}">${esc(z)}${label&&z===h[0]?" â€” "+esc(label):""}</button>`).join("");
      historyEl.querySelectorAll("button").forEach(b=>b.addEventListener("click",()=>{zipInput.value=b.dataset.zip; run()}));
    }
    clearHistBtn.addEventListener("click",()=>{ setHistory([]); renderHistory(); });

    shareBtn.addEventListener("click", async ()=>{
      const url=new URL(location.href);
      const zip=(zipInput.value||"").trim();
      if(/^\d{5}$/.test(zip)) url.searchParams.set("zip",zip);
      try{ await navigator.clipboard.writeText(url.toString()); setMsg("Share link copied.","text-green-700"); }catch{ setMsg("Could not copy link.","text-red-600"); }
    });

    async function detectZip(){
      setMsg("Detecting your ZIPâ€¦","text-gray-500");
      try{
        const pos=await new Promise((res,rej)=>{
          if(!navigator.geolocation) return rej(new Error("Geolocation not available"));
          navigator.geolocation.getCurrentPosition(res,rej,{enableHighAccuracy:true,timeout:10000,maximumAge:0});
        });
        const {latitude, longitude}=pos.coords;
        const r=await fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${latitude}&lon=${longitude}`);
        const j=await r.json(); const zip=j?.address?.postcode||"";
        if(/^\d{5}/.test(zip)){ zipInput.value=zip.slice(0,5); setMsg("Detected ZIP via GPS"); return; }
      }catch{}
      try{
        const r2=await fetch("https://ipapi.co/json/"); const j2=await r2.json(); const zip2=j2?.postal||"";
        if(/^\d{5}/.test(zip2)){ zipInput.value=zip2.slice(0,5); setMsg("Detected ZIP via network"); return; }
      }catch{}
      setMsg("Could not detect ZIP automatically.","text-red-600");
    }
    locBtn.addEventListener("click", detectZip);

    async function fetchJSON(url){
      const r = await fetch(url, {headers:{Accept:"application/json"}});
      const t = await r.text();
      if(!r.ok) throw new Error(`API ${r.status}: ${t}`);
      return JSON.parse(t);
    }

    function renderAlerts(data){
      const arr = data?.alerts || [];
      if(!arr.length){ alertsList.innerHTML=""; noAlerts.classList.remove("hidden"); return; }
      noAlerts.classList.add("hidden");
      alertsList.innerHTML = arr.slice(0,6).map(a=>
        `<li class="border rounded p-2">
          <p class="font-medium">${esc(a.title||"Alert")}</p>
          <p class="text-xs text-gray-600">${esc(a.severity||"")}${a.expires?` â€¢ until ${esc(new Date(a.expires).toLocaleString())}`:""}</p>
          ${a.link?`<p class="text-sm mt-1">${link(a.link)}</p>`:""}
        </li>`
      ).join("");
    }

    function renderQuakes(data){
      const arr = data?.quakes || [];
      if(!arr.length){ quakesList.innerHTML=""; noQuakes.classList.remove("hidden"); return; }
      noQuakes.classList.add("hidden");
      quakesList.innerHTML = arr.slice(0,6).map(q=>
        `<li class="border rounded p-2">
          <p class="font-medium">M${esc(q.magnitude)} â€” ${esc(q.place||"Nearby")}</p>
          <p class="text-xs text-gray-600">${q.time?esc(new Date(q.time).toLocaleString()):""}${q.distance_km!=null?` â€¢ ${q.distance_km} km away`:""}</p>
          ${q.url?`<p class="text-sm mt-1">${link(q.url)}</p>`:""}
        </li>`
      ).join("");
    }

    function renderBmv(data){
      const arr = data?.offices || [];
      if(!arr.length){ bmvList.innerHTML=""; noBmv.classList.remove("hidden"); return; }
      noBmv.classList.add("hidden");
      bmvList.innerHTML = arr.slice(0,6).map(b=>
        `<li class="border rounded-xl p-3">
          <p class="font-medium">${esc(b.name)}${b.distance_km!=null?` â€” <span class="text-gray-600">${b.distance_km} km</span>`:""}</p>
          ${b.address||b.locality?`<p class="text-sm">${esc([b.address,b.locality].filter(Boolean).join(", "))}</p>`:""}
          ${b.website?`<p class="text-sm mt-1">ğŸ”— ${link(b.website)}</p>`:""}
          ${b.phone?`<p class="text-sm">ğŸ“ ${esc(b.phone)}</p>`:""}
          ${b.opening_hours?`<p class="text-xs text-gray-600">Hours: ${esc(b.opening_hours)}</p>`:""}
          <div class="mt-2 flex gap-2">
            <a class="text-sm border px-2 py-1 rounded hover:bg-gray-50" target="_blank" rel="noopener" href="${esc(b.maps)}">Open in Maps</a>
            ${b.website? `<a class="text-sm border px-2 py-1 rounded hover:bg-gray-50" target="_blank" rel="noopener" href="${esc(b.website)}">Website</a>`:""}
          </div>
        </li>`
      ).join("");
    }

    function collectEmails(){
      const emails=[]; listEl.querySelectorAll("li").forEach(li=>{
        const m=li.textContent.match(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/ig);
        if(m) emails.push(...m);
      });
      return [...new Set(emails)];
    }

    copyEmailsBtn.addEventListener("click", async ()=>{
      const uniq=collectEmails();
      if(!uniq.length){ setMsg("No public emails available to copy.","text-gray-600"); return; }
      try{ await navigator.clipboard.writeText(uniq.join(", ")); setMsg("Emails copied.","text-green-700"); }catch{}
    });

    copyTextBtn.addEventListener("click", async ()=>{
      const lines=[];
      listEl.querySelectorAll("li").forEach(li=>{
        const name=li.querySelector("p.font-semibold")?.textContent?.trim()||"";
        const url=li.querySelector("a")?.href||"";
        const phone=(li.textContent.match(/ğŸ“\s*([^\n]+)/)||[])[1]||"";
        const email=(li.textContent.match(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/i)||[])[0]||"";
        lines.push([name, url?`Website: ${url}`:"", phone?`Phone: ${phone}`:"", email?`Email: ${email}`:""].filter(Boolean).join(" | "));
      });
      try{ await navigator.clipboard.writeText(lines.join("\n")); setMsg("Officials copied.","text-green-700"); }catch{ setMsg("Copy failed.","text-red-600"); }
    });

    emailBtn.addEventListener("click",()=>{
      const uniq=collectEmails();
      const zip=(zipInput.value||"").trim();
      const subject=encodeURIComponent(`Constituent inquiry from ZIP ${zip}`);
      const body=encodeURIComponent(`Dear Representative,\n\nI am a constituent from ZIP ${zip}. I am reaching out regarding [your topic here].\n\nDetails:\nâ€¢ Issue: [describe]\nâ€¢ Location (ZIP): ${zip}\nâ€¢ Suggested resolution: [optional]\n\nThank you for your service.\n\nSincerely,\n[Your Name]\n[Your Contact]\n`);
      const to = uniq.slice(0,10).join(",");
      if(!to){ alert("No public emails found. Use the website links under each official to reach their contact form."); return; }
      location.href=`mailto:${to}?subject=${subject}&body=${body}`;
    });

    document.querySelectorAll('[data-issue]').forEach(btn=>{
      btn.addEventListener('click',()=>{
        const issue = btn.getAttribute('data-issue');
        const zip=(zipInput.value||"").trim();
        const subject=encodeURIComponent(`${issue} â€” ZIP ${zip}`);
        const body=encodeURIComponent(`${issue}\n\nLocation ZIP: ${zip}\nDetails: [describe the exact location / cross street]\nPhotos: [attach if available]\n\nThank you for your help,\n[Your Name]\n[Your Contact]`);
        location.href=`mailto:?subject=${subject}&body=${body}`;
      });
    });

    const open = el=>{el.classList.remove("hidden");el.classList.add("flex")};
    const close= el=>{el.classList.add("hidden");el.classList.remove("flex")};
    aboutBtn.addEventListener("click",()=>open(aboutModal));
    contactBtn.addEventListener("click",()=>open(contactModal));
    [aboutModal,contactModal].forEach(m=>m.addEventListener("click",e=>{if(e.target===m)close(m)}));
    document.querySelectorAll('[data-close="about"]').forEach(b=>b.addEventListener("click",()=>close(aboutModal)));
    document.querySelectorAll('[data-close="contact"]').forEach(b=>b.addEventListener("click",()=>close(contactModal)));

    function setZipLinks(zip){
      if(!zip) return;
      newsBtn.href=`https://news.google.com/search?q=${encodeURIComponent(zip)}&hl=en-US&gl=US&ceid=US:en`;
    }

    async function run(){
      const zip=(zipInput.value||"").trim();
      if(!/^\d{5}$/.test(zip)){ setMsg("Please enter a valid 5â€‘digit US ZIP.","text-red-600"); return; }
      searchBtn.disabled=true; setMsg("Loadingâ€¦","text-gray-500");
      try{
        const officials = await fetchJSON(`${BACKEND_BASE}/officials?zip=${encodeURIComponent(zip)}`);
        renderOfficials(officials); setZipLinks(zip);
        const label = `${officials.place}, ${officials.state?.abbr||""}`.trim();
        pushHistory(zip,label);

        const [alerts, quakes, bmv] = await Promise.all([
          fetchJSON(`${BACKEND_BASE}/alerts?zip=${encodeURIComponent(zip)}`),
          fetchJSON(`${BACKEND_BASE}/quakes?zip=${encodeURIComponent(zip)}`),
          fetchJSON(`${BACKEND_BASE}/bmv?zip=${encodeURIComponent(zip)}&radius_km=25`),
        ]);
        renderAlerts(alerts);
        renderQuakes(quakes);
        renderBmv(bmv);

        const url=new URL(location.href); url.searchParams.set("zip",zip); history.replaceState(null,"",url.toString());
        setMsg(`Showing results for ${zip}`);
      }catch(e){ console.error(e); setMsg((e?.message||"Fetch failed")+" (see DevTools â†’ Network)","text-red-600"); }
      finally{ searchBtn.disabled=false; }
    }

    searchBtn.addEventListener("click", run);
    zipInput.addEventListener("keydown", e=>{ if(e.key==="Enter") run(); });

    const d=nextGeneralElectionDate(); electionDateEl.textContent = fmt(d);

    (function bootstrap(){
      const z=new URL(location.href).searchParams.get("zip");
      if(/^\d{5}$/.test(z||"")){ zipInput.value=z; run(); }
      else { renderHistory(); }
    })();
  </script>
</body>
</html>
HTML
