<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, user-scalable=no"
  />
  <title>EagleReach</title>
  <style>
    :root {
      --bg: #0f172a;       /* slate-900 */
      --panel: #111827;    /* gray-900 */
      --muted: #94a3b8;    /* slate-400 */
      --text: #e5e7eb;     /* gray-200 */
      --accent: #60a5fa;   /* blue-400 */
      --error: #fca5a5;    /* red-300 */
      --ok: #86efac;       /* green-300 */
      --card: #0b1220;     /* deep panel */
      --border: #1f2937;   /* gray-800 */
    }

    html, body {
      background: radial-gradient(1200px 600px at 50% -100px, #0b1220 10%, #020617 50%, #000 100%);
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      min-height: 100%;
      margin: 0;
    }

    .wrap { max-width: 900px; margin: 40px auto; padding: 0 16px; }
    h1 { font-weight: 800; font-size: 44px; margin: 0 0 6px; letter-spacing: -0.02em; }
    .sub { color: var(--muted); margin-bottom: 24px; }

    .panel {
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0));
      border: 1px solid rgba(255,255,255,0.08);
      backdrop-filter: blur(6px);
      border-radius: 14px;
      padding: 16px;
    }

    .row { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }
    input[type="text"] {
      flex: 1 1 320px;
      background: rgba(255,255,255,0.06);
      color: var(--text);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 10px;
      padding: 12px 14px;
      outline: none;
      font-size: 16px;
    }
    input[type="text"]::placeholder { color: var(--muted); }
    button {
      background: linear-gradient(180deg, #60a5fa, #2563eb);
      color: white;
      border: none;
      font-weight: 700;
      border-radius: 10px;
      padding: 12px 16px;
      cursor: pointer;
      transition: transform .05s ease;
    }
    button:active { transform: translateY(1px); }

    .status { margin-top: 10px; color: var(--muted); font-size: 14px; }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 14px;
    }
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 14px;
    }
    .title { color: var(--accent); font-weight: 800; margin-bottom: 4px; }
    .name { font-weight: 700; font-size: 18px; margin-bottom: 6px; }
    .meta, .line { color: var(--muted); font-size: 14px; }
    .line a { color: var(--accent); text-decoration: none; }
    .error { color: var(--error); }
    .ok { color: var(--ok); }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>EagleReach</h1>
    <div class="sub">Enter a <strong>5â€‘digit ZIP</strong> or a <strong>full street address</strong> to find your federal representatives.</div>

    <div class="panel">
      <div class="row">
        <input
          id="zip"
          type="text"
          inputmode="text"
          autocomplete="postal-code"
          placeholder="e.g. 62704 or â€œ1600 Pennsylvania Ave NW, Washington, DCâ€"
          onkeydown="if(event.key==='Enter'){lookup();}"
        />
        <button onclick="lookup()">Search</button>
      </div>
      <div id="status" class="status"></div>
    </div>

    <div id="results" class="grid" style="margin-top:16px;"></div>
  </div>

  <script>
    // ðŸ‘‰ your deployed backend on Render
    const API_BASE = "https://eaglereach-1.onrender.com";

    const $ = (id) => document.getElementById(id);

    function setStatus(msg, cls="") {
      const el = $("status");
      el.className = "status " + (cls || "");
      el.textContent = msg || "";
    }

    function card(o) {
      const phones = Array.isArray(o.phones) && o.phones.length ? `ðŸ“ž ${o.phones.join(", ")}` : "";
      const site   = Array.isArray(o.urls) && o.urls.length ? `<a href="${o.urls[0]}" target="_blank" rel="noopener">Website</a>` : "";
      const state  = o.state ? `State: ${o.state}` : "";
      const dist   = o.district ? ` â€¢ District: ${o.district}` : "";

      return `
        <div class="card">
          <div class="title">${o.office}</div>
          <div class="name">${o.name}${o.party ? ` (${o.party})` : ""}</div>
          <div class="meta">${state}${dist}</div>
          ${phones ? `<div class="line" style="margin-top:8px">${phones}</div>` : ""}
          ${site ? `<div class="line" style="margin-top:6px">ðŸ”— ${site}</div>` : ""}
        </div>
      `;
    }

    async function lookup() {
      const addr = ($("zip").value || "").trim();
      const results = $("results");
      results.innerHTML = "";
      if (!addr) {
        setStatus("Please enter a 5â€‘digit ZIP or a full address.", "error");
        return;
      }

      setStatus("Looking upâ€¦");

      try {
        const resp = await fetch(`${API_BASE}/ask`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ address: addr })
        });

        const data = await resp.json();

        if (!resp.ok) {
          setStatus(`Error: ${data?.detail || "Lookup failed."}`, "error");
          return;
        }

        const officials = data.officials || [];
        if (!officials.length) {
          setStatus("No officials found for that location.", "error");
          return;
        }

        // Success
        setStatus(`Found ${officials.length} official(s).`, "ok");
        results.innerHTML = officials.map(card).join("");
      } catch (err) {
        console.error(err);
        setStatus("Network error. Please try again.", "error");
      }
    }

    // Quick health check (optional visual hint)
    (async () => {
      try {
        const r = await fetch(`${API_BASE}/health`);
        if (r.ok) setStatus("API ready.", "ok");
      } catch(e) { /* ignore */ }
    })();
  </script>
</body>
</html>
